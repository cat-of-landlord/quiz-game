<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å®¶çŒ«å“ç§è¯†ç‰©èƒŒè¯µåŠ©æ‰‹ - ä¸“ä¸šç»Ÿè®¡ç‰ˆ</title>
    <style>
        :root {
            --primary-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --bg-color: #f4f7f6;
            --gray-color: #6c757d;
        }

        body { 
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; 
            margin: 0; 
            padding-top: 140px; 
            background-color: var(--bg-color); 
        }

        /* é¡¶éƒ¨å›ºå®šåŒºåŸŸ */
        .header-sticky {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 20px; text-align: center;
        }

        .header-sticky h2 { margin: 0 0 10px 0; font-size: 1.2rem; color: #333; }

        .input-group { display: flex; justify-content: center; gap: 10px; margin-bottom: 10px; }

        input { 
            padding: 12px 15px; font-size: 16px; width: 300px; 
            border: 2px solid #ddd; border-radius: 25px; transition: all 0.3s;
        }

        input:focus { border-color: var(--primary-color); outline: none; box-shadow: 0 0 8px rgba(0,123,255,0.2); }

        .progress-container {
            max-width: 600px; margin: 0 auto; background: #eee; height: 8px; border-radius: 4px; overflow: hidden;
        }

        #progressBar { width: 0%; height: 100%; background: var(--success-color); transition: width 0.3s; }

        /* ç½‘æ ¼å¸ƒå±€ */
        .quiz-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px; padding: 20px; max-width: 1200px; margin: 0 auto;
        }

        .quiz-card {
            background: white; border-radius: 12px; overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 2px solid transparent; text-align: center;
            transition: transform 0.2s;
        }

        .quiz-card.done { border-color: var(--success-color); }
        .quiz-card.missed { border-color: var(--danger-color); }

        .img-container { width: 100%; aspect-ratio: 1/1; overflow: hidden; background: #f0f0f0; }
        .quiz-img { width: 100%; height: 100%; object-fit: cover; }

        .card-info { padding: 10px; font-size: 0.85rem; }
        .user-ans { font-weight: bold; margin-bottom: 5px; min-height: 1.2em; }

        /* æ­£ç¡®ç‡è¿›åº¦æ¡å±•ç¤º */
        .acc-bar-wrap { 
            height: 6px; width: 85%; background: #eee; border-radius: 3px; margin: 5px auto; 
            display: none; 
        }
        .acc-bar-fill { height: 100%; border-radius: 3px; }

        /* ç»“æœåŒºåŸŸ */
        .result-area {
            max-width: 800px; margin: 20px auto; background: white; 
            padding: 30px; border-radius: 12px; text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .stat-box {
            background: #f8f9fa; border: 1px solid #ddd; padding: 20px;
            border-radius: 8px; margin: 20px 0; line-height: 1.8; font-size: 1.1rem;
        }

        .stat-box span { font-weight: bold; color: var(--primary-color); font-size: 1.3em; }

        button {
            padding: 10px 25px; border-radius: 20px; border: none;
            cursor: pointer; font-weight: bold; transition: opacity 0.2s;
        }
        #endBtn { background: var(--gray-color); color: white; }
        #restartBtn { background: var(--primary-color); color: white; }
        button:hover { opacity: 0.8; }

        .hidden { display: none; }
        .message-tip { height: 20px; font-size: 14px; margin-top: 5px; font-weight: bold; }
    </style>
</head>
<body>

<div class="header-sticky">
    <h2>è¯·è¾“å…¥ç­”æ¡ˆ (<span id="countInfo">0/0</span>)</h2>
    <div class="input-group">
        <input id="answerInput" type="text" placeholder="çœ‹å›¾çŒœåï¼Œå›è½¦ç¡®è®¤..." autofocus>
        <button onclick="endQuiz()" id="endBtn">æäº¤å¹¶æŸ¥çœ‹æ’å</button>
        <button onclick="restartQuiz()" class="hidden" id="restartBtn">é‡æ–°å¼€å§‹</button>
    </div>
    <div class="progress-container"><div id="progressBar"></div></div>
    <div id="message" class="message-tip"></div>
</div>

<div class="quiz-grid" id="quizGrid"></div>

<div id="resultArea" class="hidden result-area">
    <h3>ğŸ“Š æœ€ç»ˆæˆç»©ç»Ÿè®¡ (Scoring)</h3>
    <div class="stat-box" id="statSummary"></div>
</div>

<script>
    // æ•´åˆä½ æä¾›çš„å®Œæ•´ alts åˆ—è¡¨ï¼Œå¹¶é¢„è®¾å…¨çƒæ­£ç¡®ç‡æ•°æ®
    const quizData = [
        { img: "é˜¿æ¯”è¥¿å°¼äºšçŒ«.jpg", alts: ["é˜¿æ¯”è¥¿å°¼äºšçŒ«","å…”çŒ«","Abyssinian"], acc: 42 },
        { img: "åŸƒåŠçŒ«.jpg", alts: ["åŸƒåŠçŒ«","Egyptian Mau","Mau"], acc: 38 },
        { img: "å·´å˜å²›çŒ«.jpg", alts: ["å·´å˜å²›çŒ«","å·´é‡ŒçŒ«","å·´å˜çŒ«","çˆªå“‡çŒ«","Balinese","Javanese"], acc: 25 },
        { img: "æ³¢ç±³æ‹‰çŒ«.jpg", alts: ["æ³¢ç±³æ‹‰çŒ«","æŸç±³æ‹‰çŒ«","åšç¾æ‹‰çŒ«","Burmilla"], acc: 15 },
        { img: "æ³¢æ–¯çŒ«.jpg", alts: ["æ³¢æ–¯çŒ«","Persian"], acc: 88 },
        { img: "ä¼¯æ›¼çŒ«.jpg", alts: ["ä¼¯æ›¼çŒ«","ç¼…ç”¸åœ£çŒ«","åœ£çŒ«","Birman"], acc: 35 },
        { img: "å¸ƒå¶çŒ«.jpg", alts: ["å¸ƒå¶çŒ«","æ‹‰æ ¼é“å°”çŒ«","Ragdoll"], acc: 82 },
        { img: "å¾·æ–‡å¸ç‹çŒ«.jpg", alts: ["å¾·æ–‡å¸ç‹çŒ«","å¾·æ–‡å·æ¯›çŒ«","å¾·æ–‡åŠ›å…‹æ–¯çŒ«","Devon Rex"], acc: 31 },
        { img: "ä¸œæ–¹çŒ«.jpg", alts: ["ä¸œæ–¹çŒ«","ä¸œæ–¹çŸ­æ¯›çŒ«","Oriental Shorthair","Oriental"], acc: 22 },
        { img: "ä¸œå¥‡å°¼çŒ«.jpg", alts: ["ä¸œå¥‡å°¼çŒ«","æ±¤é‡‘æ–¯çŒ«","æ‰˜é‡‘æ–¯çŒ«","Tonkinese"], acc: 18 },
        { img: "ä¿„ç½—æ–¯è“çŒ«.jpg", alts: ["ä¿„ç½—æ–¯è“çŒ«","é˜¿å¥‘å®‰å‰è“çŒ«","Russian Blue"], acc: 75 },
        { img: "å“ˆç“¦é‚£æ£•çŒ«.jpg", alts: ["å“ˆç“¦é‚£æ£•çŒ«","å“ˆç“¦é‚£çŒ«","Havana Brown"], acc: 12 },
        { img: "æŸ¯å°¼æ–¯å·æ¯›çŒ«.jpg", alts: ["æŸ¯å°¼æ–¯å·æ¯›çŒ«","åº·æ²ƒå°”å·æ¯›çŒ«","ç§‘å°¼æ–¯å·æ¯›çŒ«","Cornish Rex"], acc: 28 },
        { img: "å…‹æ‹‰ç‰¹çŒ«.jpg", alts: ["å…‹æ‹‰ç‰¹çŒ«","ç§‘æ‹‰ç‰¹çŒ«","å‘µå»çŒ«","å‰ç¥¥çŒ«","Korat"], acc: 14 },
        { img: "æ‹‰æ³¢å·æ¯›çŒ«.jpg", alts: ["æ‹‰æ³¢å·æ¯›çŒ«","æ‹‰æ³¢çŒ«","è±åšçŒ«","LaPerm"], acc: 11 },
        { img: "è¤´è¤›çŒ«.jpg", alts: ["è¤´è¤›çŒ«","å‹’å˜‰å¾·æ‘©çŒ«","Ragamuffin"], acc: 20 },
        { img: "ç‹¼çŒ«.jpg", alts: ["ç‹¼çŒ«","è±ç§‘çŒ«","Lykoi"], acc: 36 },
        { img: "é©¬æ©å²›çŒ«.jpg", alts: ["é©¬æ©å²›çŒ«","æ›¼å²›çŒ«","æ›¼å…‹æ–¯çŒ«","Manx"], acc: 33 },
        { img: "ç¾å›½çŸ­æ¯›çŒ«.jpg", alts: ["ç¾å›½çŸ­æ¯›çŒ«","ç¾çŸ­","American Shorthair"], acc: 85 },
        { img: "ç¾å›½çŸ­å°¾çŒ«.jpg", alts: ["ç¾å›½çŸ­å°¾çŒ«","ç¾çŸ­å°¾","American Bobtail"], acc: 32 },
        { img: "ç¾å›½å·è€³çŒ«.jpg", alts: ["ç¾å›½å·è€³çŒ«","ç¾å›½åè€³çŒ«","American Curl"], acc: 45 },
        { img: "ç¾å›½ç¡¬æ¯›çŒ«.jpg", alts: ["ç¾å›½ç¡¬æ¯›çŒ«","ç¾å›½åˆšæ¯›çŒ«","American Wirehair"], acc: 19 },
        { img: "å­ŸåŠ æ‹‰çŒ«.jpg", alts: ["å­ŸåŠ æ‹‰çŒ«","è±¹çŒ«","å­ŸåŠ æ‹‰è±¹çŒ«","Bengal"], acc: 78 },
        { img: "å­Ÿä¹°çŒ«.jpg", alts: ["å­Ÿä¹°çŒ«","å°é»‘è±¹","Bombay"], acc: 55 },
        { img: "ç¼…ç”¸çŒ«.jpg", alts: ["ç¼…ç”¸çŒ«","ç¼…æ‘©çŒ«","Burmese"], acc: 48 },
        { img: "ç¼…å› çŒ«.jpg", alts: ["ç¼…å› çŒ«","ç¼…å› åº“æ©çŒ«","Maine Coon"], acc: 80 },
        { img: "æŒªå¨æ£®æ—çŒ«.jpg", alts: ["æŒªå¨æ£®æ—çŒ«","æŒªå¨æ£®","Norwegian Forest Cat"], acc: 62 },
        { img: "æ¬§è¥¿çŒ«.jpg", alts: ["æ¬§è¥¿çŒ«","å¥¥è¥¿çŒ«","Ocicat"], acc: 17 },
        { img: "æ¬§æ´²ç¼…ç”¸çŒ«.jpg", alts: ["æ¬§æ´²ç¼…ç”¸çŒ«","European Burmese"], acc: 21 },
        { img: "æ—¥æœ¬çŸ­å°¾çŒ«.jpg", alts: ["æ—¥æœ¬çŸ­å°¾çŒ«","æ‹›è´¢çŒ«","Japanese Bobtail"], acc: 40 },
        { img: "èµ›å°”å‡¯å…‹å·æ¯›çŒ«.jpg", alts: ["èµ›å°”å‡¯å…‹å·æ¯›çŒ«","å¡å°”å‡¯å…‹å·æ¯›çŒ«","ç¾Šçš®ç­å­çŒ«","Selkirk Rex"], acc: 26 },
        { img: "æ–¯èŠ¬å…‹æ–¯çŒ«.jpg", alts: ["æ–¯èŠ¬å…‹æ–¯çŒ«","åŠ æ‹¿å¤§æ— æ¯›çŒ«","æ— æ¯›çŒ«","Sphynx"], acc: 72 },
        { img: "è‹æ ¼å…°æŠ˜è€³çŒ«.jpg", alts: ["è‹æ ¼å…°æŠ˜è€³çŒ«","æŠ˜è€³çŒ«","Scottish Fold"], acc: 79 },
        { img: "ç´¢é©¬é‡ŒçŒ«.jpg", alts: ["ç´¢é©¬é‡ŒçŒ«","Somali"], acc: 30 },
        { img: "æ³°å›½å¾¡çŒ«.jpg", alts: ["æ³°å›½å¾¡çŒ«","è€ƒç›å°¼çŒ«","Khao Manee"], acc: 16 },
        { img: "åœŸè€³å…¶å®‰å“¥æ‹‰çŒ«.jpg", alts: ["åœŸè€³å…¶å®‰å“¥æ‹‰çŒ«","å®‰å“¥æ‹‰çŒ«","Turkish Angora"], acc: 34 },
        { img: "åœŸè€³å…¶æ¢µçŒ«.jpg", alts: ["åœŸè€³å…¶æ¢µçŒ«","æ¢µçŒ«","Turkish Van"], acc: 37 },
        { img: "è¥¿ä¼¯åˆ©äºšçŒ«.jpg", alts: ["è¥¿ä¼¯åˆ©äºšçŒ«","è¥¿ä¼¯åˆ©äºšæ£®æ—çŒ«","Siberian"], acc: 44 },
        { img: "å¤ç‰¹å°”çŒ«.jpg", alts: ["å¤ç‰¹å°”çŒ«","æ²™ç‰¹å°”çŒ«","Chartreux"], acc: 29 },
        { img: "æš¹ç½—çŒ«.jpg", alts: ["æš¹ç½—çŒ«","æ³°å›½çŒ«","Siamese"], acc: 86 },
        { img: "æ–°åŠ å¡çŒ«.jpg", alts: ["æ–°åŠ å¡çŒ«","Singpura"], acc: 23 },
        { img: "å¼‚å›½çŒ«.jpg", alts: ["å¼‚å›½çŒ«","å¼‚å›½çŸ­æ¯›çŒ«","åŠ è²çŒ«","Exotic Shorthair"], acc: 83 },
        { img: "è‹±å›½çŸ­æ¯›çŒ«.jpg", alts: ["è‹±å›½çŸ­æ¯›çŒ«","è‹±çŸ­","British Shorthair"], acc: 91 },
        { img: "é‡ç‚¹è‰²çŸ­æ¯›çŒ«.jpg", alts: ["é‡ç‚¹è‰²çŸ­æ¯›çŒ«","ç«¯å­è‰²çŸ­æ¯›çŒ«","Colorpoint Shorthair"], acc: 27 }
    ];

    let userCorrectIndexes = [];
    let ended = false;
    const inputBox = document.getElementById("answerInput");
    const grid = document.getElementById("quizGrid");

    function initGrid() {
        grid.innerHTML = "";
        quizData.forEach((item, index) => {
            const card = document.createElement("div");
            card.className = "quiz-card";
            card.id = `card-${index}`;
            const barColor = item.acc > 60 ? "#28a745" : (item.acc > 30 ? "#ffc107" : "#dc3545");
            card.innerHTML = `
                <div class="img-container"><img src="${item.img}" class="quiz-img"></div>
                <div class="card-info">
                    <div id="ans-text-${index}" class="user-ans">-</div>
                    <div class="acc-bar-wrap" id="acc-wrap-${index}">
                        <div class="acc-bar-fill" style="width:${item.acc}%; background:${barColor}"></div>
                        <div style="font-size:10px; color:#666; margin-top:2px">æ­£ç¡®ç‡: ${item.acc}%</div>
                    </div>
                </div>
            `;
            grid.appendChild(card);
        });
        updateProgress();
    }

    inputBox.addEventListener("keydown", (e) => { if (e.key === "Enter" && !ended) checkAnswer(); });

    function checkAnswer() {
        const input = inputBox.value.trim().toLowerCase();
        const message = document.getElementById("message");
        if (!input) return;

        let foundIndex = quizData.findIndex(item => 
            item.alts.some(a => a.toLowerCase() === input)
        );

        if (foundIndex !== -1) {
            if (!userCorrectIndexes.includes(foundIndex)) {
                userCorrectIndexes.push(foundIndex);
                message.innerHTML = `<span style="color:var(--success-color)">âœ” åŒ¹é…æ­£ç¡®ï¼</span>`;
                markAsDone(foundIndex, input);
            } else {
                message.innerHTML = `<span style="color:orange">âš  å·²è¯†åˆ«è¿‡è¯¥å“ç§</span>`;
            }
        } else {
            message.innerHTML = `<span style="color:var(--danger-color)">âœ˜ æœªåŒ¹é…åˆ°ç›¸å…³å“ç§</span>`;
        }
        inputBox.value = "";
        updateProgress();
    }

    function markAsDone(index, input) {
        const card = document.getElementById(`card-${index}`);
        card.classList.add("done");
        document.getElementById(`ans-text-${index}`).innerText = input;
        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function updateProgress() {
        const count = userCorrectIndexes.length;
        document.getElementById("countInfo").innerText = `${count}/${quizData.length}`;
        document.getElementById("progressBar").style.width = `${(count/quizData.length)*100}%`;
    }

    // æ­£æ€åˆ†å¸ƒæ¨¡æ‹Ÿï¼šè®¡ç®—æ‰“è´¥ç™¾åˆ†æ¯”
    function calculatePercentile(score) {
        const mean = 18.5; 
        const stdDev = 8.0; 
        const z = (score - mean) / stdDev;
        const t = 1 / (1 + 0.2315419 * Math.abs(z));
        const d = 0.3989423 * Math.exp(-z * z / 2);
        let prob = d * t * (0.3193815 + t * (-0.3565638 + t * (1.781478 + t * (-1.821256 + t * 1.330274))));
        if (z > 0) prob = 1 - prob;
        return Math.round(prob * 1000) / 10;
    }

    function endQuiz() {
        ended = true;
        inputBox.disabled = true;
        
        quizData.forEach((item, index) => {
            document.getElementById(`acc-wrap-${index}`).style.display = "block";
            if (!userCorrectIndexes.includes(index)) {
                document.getElementById(`card-${index}`).classList.add("missed");
                document.getElementById(`ans-text-${index}`).innerHTML = `<span style="color:var(--danger-color)">${item.alts[0]}</span>`;
            }
        });

        const score = userCorrectIndexes.length;
        const total = quizData.length;
        const percentile = calculatePercentile(score);
        const avgScore = 18.5;

        document.getElementById("statSummary").innerHTML = `
            ä½ è·å¾—äº† <span>${score}</span> / ${total} åˆ† (<span>${Math.round(score/total*100)}%</span>)<br>
            è¿™è¶…è¿‡äº†å…¨çƒ <span>${percentile}%</span> çš„æŒ‘æˆ˜è€…ã€‚<br>
            å…¨çƒå¹³å‡åˆ†æ•°æ˜¯ <span>${avgScore}</span> åˆ†ã€‚
        `;
        
        document.getElementById("resultArea").classList.remove("hidden");
        document.getElementById("restartBtn").classList.remove("hidden");
        document.getElementById("endBtn").classList.add("hidden");
        window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
    }

    function restartQuiz() {
        location.reload();
    }

    initGrid();
</script>
</body>
</html>
